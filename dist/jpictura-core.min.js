var jpictura=jpictura||{};jpictura.debounce=function(t,i,e){var a;return function(){var n=this,o=arguments,r=function(){a=null,e||t.apply(n,o)},s=e&&!a;clearTimeout(a),a=setTimeout(r,i),s&&t.apply(n,o)}},jpictura.offWindowWidthResize=function(t){$(window).off("."+t)},jpictura.onWindowWidthResize=function(t,i){var e=$(window),a=e.width();e.on("resize."+t,function(){var t=e.width();a!==t&&(i(),a=t)})};var jpictura=jpictura||{};jpictura.heightCalculator=function(t,i,e){function a(t){n(t),o(t),s()}function n(t){var i=0,e=f.layout.idealRowHeight,a=f.layout.maxWidthHeightRatio;u=t/((t-i)/e+a)}function o(t){var i=0,e=f.layout.idealRowHeight,a=f.layout.maxWidthHeightRatio;a*e>=t?(f.debug&&d("The max width/height ratio "+a+" is too big for row width "+t+"px."),c=t*a):c=t/((t+i)/e-a)}function r(t,i){var e,a,n=0;do e=g(t,h,!1,f),e>i?c=h:u=h,s(u,c),a=!1,i<e&&(a=!0),i-e>f.algorithm.epsilon&&(a=!0),++n>=f.algorithm.maxIterationCount&&(a=!1);while(a);return n>=f.algorithm.maxIterationCount&&f.debug&&d("Max "+n+" iterations reached. Current precision: "+(i-e)+"."),h}function s(){h=(u+c)/2}function l(t,i,e){t=Math.floor(t);var a;do a=g(i,t,!0,f);while(a<e&&t++);return t}var u,c,h,d=i,g=t,f=e;this.getHeight=function(t,i){if(0===t.length)return 0;a(i);var e=r(t,i);return e=l(e,t,i)}};/*!
 * jPictura v0.1.1
 * https://github.com/anmarcek/jpictura.git
 *
 * Copyright (c) 2015-2016 Anton Marček
 * Released under the MIT license
 *
 * Date: 2016-08-10T07:41:40.257Z
 */
var jpictura=jpictura||{};!function(t){function i(t,i){t.addClass(i.classes.container),t.toggleClass("stretch-images",i.layout.stretchImages),t.toggleClass("center-images",i.layout.centerImages),t.toggleClass("disable-cropping-images",!i.layout.allowCropping),t.toggleClass("fade-in-items",i.effects.fadeInItems);var a=t.find(i.selectors.item);a.addClass(i.classes.item);var o=a.find(i.selectors.image);o.addClass(i.classes.image),e(t,a,i,n)}function e(t,i,e,n){e.waitForImages?a(t,i,e,n):n(t,i,e)}function a(i,e,a,n){function o(t,o){var s=o.width/o.height;P(t,s),++r===e.size()&&n(i,e,a)}var r=0;e.each(function(){var i=t(this),e=i.find(a.selectors.image),n=new Image;n.src=e.attr("src"),t(n).load(function(){o(i,n)})})}function n(t,i,e){var a=jpictura.debounce(function(){r(t,i,e)},e.responsive.debounce);o(a,t,e),a()}function o(t,i,e){jpictura.offWindowWidthResize($),e.responsive.enabled&&e.responsive.onWindowWidthResize&&jpictura.onWindowWidthResize($,t);var a=$+"-resize-interval",n=i.data(a);if(clearInterval(n),i.data(a,null),e.responsive.enabled&&e.responsive.onContainerWidthResize){var o=F(i);n=setInterval(function(){var e=F(i);e!==o&&(o=e,t())},e.responsive.containerResizeInterval),i.data(a,n)}}function r(t,i,e){s(t,0);var a,n=(new Date).getTime(),o=10,r=0,l=[];do{i.addClass(e.classes.invisible),i.addClass(e.classes.hidden);var c=F(t);l.push(c);var h=!1;if(l.length>=3){var d=l[l.length-3],g=l[l.length-2];d>g&&d===c&&(c=g,h=!0)}u(c,i,e);var f=F(t);if(l.push(f),a=!1,c!==f){var p=l[l.length-2];a=!h||p!==f}}while(a&&++r<=o);var v=(new Date).getTime();r>o&&e.debug?E("Max redraw tries of "+o+"reached. Gallery redraw failed."):e.debug&&E("Gallery redrawn in "+(v-n)+" milliseconds."),s(t,null)}function s(t,i){t.data(l(),i)}function l(){return $+"-redraw-progress"}function u(i,e,a){var n=[],o=i-2*a.layout.rowPadding,r=new a.heightCalculator(H,E,a);e.each(function(){var i=t(this);if(0===n.length)n.push(i);else{var e=n.slice(0);if(e.push(i),c(e,o,a)){var s=h(n,o,r,a),l=h(e,o,r,a),u=t.fn.jpictura.evaluate(s,a),g=t.fn.jpictura.evaluate(l,a);u>g?n.push(i):(d(n,o,s,!1,a),n=[],n.push(i))}else n.push(i)}});var s=c(n,o,a)||a.layout.justifyLastRow?h(n,o,r,a):a.layout.idealRowHeight;d(n,o,s,!0,a)}function c(t,i,e){for(var a=(t.length-1)*e.layout.itemSpacing,n=0;n<t.length;n++)a+=M(t[n],e.layout.idealRowHeight,e);return a>i}function h(t,i,e,a){var n=z(t,i,a);return e.getHeight(t,n)}function d(t,i,e,a,n){for(var o=H(t,e,!0,n),r=z(t,i,n),s={row:t,width:i,height:e,isLastRow:a,itemsSpaceWidth:r,itemsWidthDelta:o-r,unassignedItemsWidthDelta:o-r},l=g(t,n),u=0;u<l.length;u++)f(l[u],s,n)}function g(t,i){var e=t.slice(0);return e.sort(function(t,e){return D(e,!0,i)-D(t,!0,i)}),e}function f(t,i,e){var a=i.row,n=i.isLastRow,o=t===a[0],r=t===a[a.length-1],s=p(t,i,e),l=i.height,u=t.find(e.selectors.image);m(t,s,l),w(t,e),y(t,n,o,r,e),R(t,o,r,e),C(t,r,n,e),W(t,s,l,e),I(u,s,l,e)}function p(t,i,e){var a=M(t,i.height,e),n=v(a,i);return Math.floor(a)-n}function v(t,i){if(i.unassignedItemsWidthDelta<=0)return 0;var e=Math.ceil(t/i.itemsSpaceWidth*i.itemsWidthDelta);return i.unassignedItemsWidthDelta<e&&(e=i.unassignedItemsWidthDelta),i.unassignedItemsWidthDelta-=e,e}function m(t,i,e){t.width(i),t.height(e)}function w(t,i){t.removeClass(i.classes.invisible),t.removeClass(i.classes.hidden)}function y(t,i,e,a,n){t.toggleClass(n.classes.lastRow,i),t.toggleClass(n.classes.firstInRow,e),t.toggleClass(n.classes.lastInRow,a)}function R(t,i,e,a){var n={left:"",right:""};a.layout.applyRowPadding&&(n.left=(i?a.layout.rowPadding:0)+"px",n.right=(e?a.layout.rowPadding:0)+"px"),t.css("margin-left",n.left),t.css("margin-right",n.right)}function C(t,i,e,a){var n={right:"",bottom:""};a.layout.applyItemSpacing&&(n.right=(i?0:a.layout.itemSpacing)+"px",n.bottom=(e?0:a.layout.itemSpacing)+"px"),t.css("margin-right",n.right),t.css("margin-bottom",n.bottom)}function W(t,i,e,a){var n=D(t,!1,a)*e;t.toggleClass("stretch-by-height",n>=i),t.toggleClass("stretch-by-width",n<i);var o=b(n,i,a);t.toggleClass("cropped-if-stretched",o)}function I(t,i,e){t.toggleClass("horizontal-misfit",j(t,i)),t.toggleClass("vertical-misfit",x(t,e))}function b(t,i,e){return Math.abs(t-i)>e.layout.croppingEpsilon}function j(t,i){return Math.abs(t.width()-i)>1}function x(t,i){return Math.abs(t.height()-i)>1}function H(t,i,e,a){for(var n=0,o=0;o<t.length;o++){var r=M(t[o],i,a);e&&(r=Math.floor(r)),n+=r}return n}function z(t,i,e){return i-(t.length-1)*e.layout.itemSpacing}function M(t,i,e){return D(t,!0,e)*i}function D(t,i,e){var a=$+"-ratio",n=t.data(a);if(void 0===n&&(n=S(t,e),t.data(a,n)),i){if(n<=e.layout.minWidthHeightRatio)return e.layout.minWidthHeightRatio;if(n>=e.layout.maxWidthHeightRatio)return e.layout.maxWidthHeightRatio}return n}function S(t,i){var e=L(t,i),a=T(t,i);return e/a}function P(t,i){var e=$+"-ratio";t.data(e,i)}function L(t,i){var e=$+"-width",a=t.data(e);if(void 0===a){var n=t.find(i.selectors.image);a=n.prop("naturalWidth"),t.data(e,a)}return a}function T(t,i){var e=$+"-height",a=t.data(e);if(void 0===a){var n=t.find(i.selectors.image);a=n.prop("naturalHeight"),t.data(e,a)}return a}function F(t){return t.width()}function E(t){window.console&&console.log(G+": "+t)}t.fn.jpictura=function(e){var a=t.extend(!0,{},t.fn.jpictura.defaults,e);return this.each(function(){i(t(this),a)}),this};var G="jPictura",$=G.toLowerCase();t.fn.jpictura.defaults={selectors:{item:".item",image:"img"},classes:{container:$,item:$+"-item",image:$+"-image",lastRow:$+"-last-row",firstInRow:$+"-first-in-row",lastInRow:$+"-last-in-row",invisible:$+"-invisible",hidden:$+"-hidden",offContentFlow:$+"-off-content-flow"},layout:{rowPadding:0,applyRowPadding:!0,itemSpacing:5,applyItemSpacing:!0,idealRowHeight:180,minWidthHeightRatio:1/3,maxWidthHeightRatio:3,stretchImages:!0,allowCropping:!0,croppingEpsilon:3,centerImages:!0,justifyLastRow:!1},effects:{fadeInItems:!1},responsive:{enabled:!0,onWindowWidthResize:!0,onContainerWidthResize:!0,containerResizeInterval:50,debounce:200},waitForImages:!0,heightCalculator:jpictura.heightCalculator,algorithm:{epsilon:.01,maxIterationCount:50},debug:!1},t.fn.jpictura.evaluate=function(t,i){return Math.abs(t-i.layout.idealRowHeight)}}(jQuery);